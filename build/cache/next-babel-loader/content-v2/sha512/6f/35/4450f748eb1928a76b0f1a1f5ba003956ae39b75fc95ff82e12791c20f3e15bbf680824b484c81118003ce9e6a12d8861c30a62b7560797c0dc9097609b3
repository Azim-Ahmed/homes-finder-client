{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"C:/Users/ASUS/Documents/Projects/assignment/VegaHomes/client/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:/Users/ASUS/Documents/Projects/assignment/VegaHomes/client/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/ASUS/Documents/Projects/assignment/VegaHomes/client/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Documents\\\\Projects\\\\assignment\\\\VegaHomes\\\\client\\\\src\\\\pages\\\\login.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useContext, useEffect, useState } from 'react';\nimport { Col, Container, Row, Button } from 'react-bootstrap';\nimport { UserContext } from './_app';\nimport Link from 'next/link';\nimport styles from '../styles/login.module.css';\nimport firebase from 'firebase/app';\nimport 'firebase/auth';\nimport firebaseConfig from '../firebase.config';\nimport { useRouter } from 'next/router';\nimport Image from 'next/image';\n\nvar Login = function Login() {\n  _s();\n\n  var router = useRouter();\n  var dashboardSection = '/dashboard/home';\n  var loginSection = '/login';\n\n  var _useContext = useContext(UserContext),\n      appData = _useContext[0],\n      setAppData = _useContext[1],\n      loggedIn = _useContext[2],\n      setLoggedIn = _useContext[3];\n\n  var _useState = useState({\n    email: '',\n    name: ''\n  }),\n      userData = _useState[0],\n      setUserData = _useState[1];\n\n  var _useState2 = useState(null),\n      adminEmails = _useState2[0],\n      setAdminEmails = _useState2[1];\n\n  var _useState3 = useState(false),\n      admin = _useState3[0],\n      setAdmin = _useState3[1];\n\n  if (firebase.apps.length === 0) {\n    firebase.initializeApp(firebaseConfig);\n  }\n\n  useEffect( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var response;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch('http://localhost:2000/api/admin/getAllAdmins');\n\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return response.json();\n\n          case 5:\n            response = _context.sent;\n            setAdminEmails(response.email);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  console.log(adminEmails); // localStorage.setItem('_increment', JSON.stringify(appData));\n  // }, []);\n\n  var handleGoogleSignIn = function handleGoogleSignIn() {\n    var provider = new firebase.auth.GoogleAuthProvider();\n    firebase.auth().signInWithPopup(provider).then( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result) {\n        var _yield$result$user, displayName, email, loggedInUser, adminEmail;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return result.user;\n\n              case 2:\n                _yield$result$user = _context2.sent;\n                displayName = _yield$result$user.displayName;\n                email = _yield$result$user.email;\n                loggedInUser = {\n                  name: displayName,\n                  email: email\n                }; //localStorage.setItem('data', loggedInUser);\n\n                setUserData(_objectSpread(_objectSpread({}, loggedInUser), {}, {\n                  name: displayName,\n                  email: email\n                })); //localStorage.setItem('data', loggedInUser);\n                // window.store = loggedInUser;\n\n                console.log(loggedInUser);\n                console.log(userData);\n                adminEmail = adminEmails.filter(function (data) {\n                  return data.email == loggedInUser.email;\n                });\n                console.log(adminEmail);\n\n                if (!adminEmail[0].email) {\n                  setAdmin(false);\n                  router.push(loginSection);\n                }\n\n                if (adminEmail[0].email) {\n                  setAdmin(true);\n                  router.push(dashboardSection);\n                } // if (typeof window !== 'undefined') {\n                //   localStorage.setItem(data, loggedInUser);\n                // }\n\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }())[\"catch\"](function (error) {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n      var email = error.email;\n      var credential = error.credential;\n      console.log(errorCode, email, credential, errorMessage);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"my-5 text-center\",\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        className: styles.authSection,\n        md: {\n          span: 6,\n          offset: 3\n        },\n        sm: {\n          span: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: [' ', /*#__PURE__*/_jsxDEV(Image, {\n              src: \"/favicon.png\",\n              width: 300,\n              height: 100,\n              alt: \"logo image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.googleAuthSection,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outline-danger\",\n            onClick: handleGoogleSignIn,\n            children: \"Continue With google\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Login, \"DkGM6FKh6mL4rgnDjOq5QqZzFfQ=\", false, function () {\n  return [useRouter];\n});\n\n_c = Login;\nexport default Login; // export async function getServerSideProps() {\n//   const res = await fetch('');\n//   const getAdminEmail = await res.json();\n//   return {\n//     props: {\n//       getAdminEmail,\n//     },\n//   };\n// }\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["C:/Users/ASUS/Documents/Projects/assignment/VegaHomes/client/src/pages/login.jsx"],"names":["useContext","useEffect","useState","Col","Container","Row","Button","UserContext","Link","styles","firebase","firebaseConfig","useRouter","Image","Login","router","dashboardSection","loginSection","appData","setAppData","loggedIn","setLoggedIn","email","name","userData","setUserData","adminEmails","setAdminEmails","admin","setAdmin","apps","length","initializeApp","fetch","response","json","console","log","handleGoogleSignIn","provider","auth","GoogleAuthProvider","signInWithPopup","then","result","user","displayName","loggedInUser","adminEmail","filter","data","push","error","errorCode","code","errorMessage","message","credential","authSection","span","offset","googleAuthSection"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from 'react';\r\nimport { Col, Container, Row, Button } from 'react-bootstrap';\r\nimport { UserContext } from './_app';\r\nimport Link from 'next/link';\r\nimport styles from '../styles/login.module.css';\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\nimport firebaseConfig from '../firebase.config';\r\nimport { useRouter } from 'next/router';\r\nimport Image from 'next/image';\r\n\r\nconst Login = () => {\r\n  const router = useRouter();\r\n  const dashboardSection = '/dashboard/home';\r\n  const loginSection = '/login';\r\n  const [appData, setAppData, loggedIn, setLoggedIn] = useContext(UserContext);\r\n  const [userData, setUserData] = useState({\r\n    email: '',\r\n    name: '',\r\n  });\r\n  const [adminEmails, setAdminEmails] = useState(null);\r\n  const [admin, setAdmin] = useState(false);\r\n  if (firebase.apps.length === 0) {\r\n    firebase.initializeApp(firebaseConfig);\r\n  }\r\n\r\n  useEffect(async () => {\r\n    let response = await fetch('http://localhost:2000/api/admin/getAllAdmins');\r\n    response = await response.json();\r\n    setAdminEmails(response.email);\r\n  }, []);\r\n  console.log(adminEmails);\r\n\r\n  // localStorage.setItem('_increment', JSON.stringify(appData));\r\n  // }, []);\r\n\r\n  const handleGoogleSignIn = () => {\r\n    var provider = new firebase.auth.GoogleAuthProvider();\r\n    firebase\r\n      .auth()\r\n      .signInWithPopup(provider)\r\n      .then(async function (result) {\r\n        const { displayName, email } = await result.user;\r\n        const loggedInUser = { name: displayName, email };\r\n        //localStorage.setItem('data', loggedInUser);\r\n        setUserData({\r\n          ...loggedInUser,\r\n          name: displayName,\r\n          email: email,\r\n        });\r\n        //localStorage.setItem('data', loggedInUser);\r\n        // window.store = loggedInUser;\r\n\r\n        console.log(loggedInUser);\r\n        console.log(userData);\r\n        let adminEmail = adminEmails.filter(\r\n          (data) => data.email == loggedInUser.email\r\n        );\r\n        console.log(adminEmail);\r\n\r\n        if (!adminEmail[0].email) {\r\n          setAdmin(false);\r\n          router.push(loginSection);\r\n        }\r\n\r\n        if (adminEmail[0].email) {\r\n          setAdmin(true);\r\n          router.push(dashboardSection);\r\n        }\r\n\r\n        // if (typeof window !== 'undefined') {\r\n        //   localStorage.setItem(data, loggedInUser);\r\n        // }\r\n      })\r\n      .catch(function (error) {\r\n        var errorCode = error.code;\r\n        var errorMessage = error.message;\r\n        var email = error.email;\r\n        var credential = error.credential;\r\n        console.log(errorCode, email, credential, errorMessage);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <Row className=\"my-5 text-center\">\r\n        <Col\r\n          className={styles.authSection}\r\n          md={{ span: 6, offset: 3 }}\r\n          sm={{ span: 12 }}\r\n        >\r\n          <Link href=\"/\">\r\n            <a>\r\n              {' '}\r\n              <Image\r\n                src=\"/favicon.png\"\r\n                width={300}\r\n                height={100}\r\n                alt=\"logo image\"\r\n              />\r\n            </a>\r\n          </Link>\r\n          <div className={styles.googleAuthSection}>\r\n            <Button variant=\"outline-danger\" onClick={handleGoogleSignIn}>\r\n              Continue With google\r\n            </Button>\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n\r\n// export async function getServerSideProps() {\r\n//   const res = await fetch('');\r\n//   const getAdminEmail = await res.json();\r\n\r\n//   return {\r\n//     props: {\r\n//       getAdminEmail,\r\n//     },\r\n//   };\r\n// }\r\n"]},"metadata":{},"sourceType":"module"}