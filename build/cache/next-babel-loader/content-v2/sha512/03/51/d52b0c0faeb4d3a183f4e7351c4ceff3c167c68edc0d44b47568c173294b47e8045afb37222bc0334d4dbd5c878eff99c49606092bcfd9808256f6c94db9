{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _defineProperty from \"C:/Users/ASUS/Documents/Projects/assignment/VegaHomes/client/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:/Users/ASUS/Documents/Projects/assignment/VegaHomes/client/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/ASUS/Documents/Projects/assignment/VegaHomes/client/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useContext, useEffect, useState } from 'react';\nimport { Col, Container, Row, Button } from 'react-bootstrap';\nimport { UserContext } from './_app';\nimport Link from 'next/link';\nimport styles from '../styles/login.module.css';\nimport firebase from 'firebase/app';\nimport 'firebase/auth';\nimport firebaseConfig from '../firebase.config';\nimport { useRouter } from 'next/router';\nimport Image from 'next/image';\n\nvar Login = function Login() {\n  var router = useRouter();\n  var dashboardSection = '/dashboard/home';\n  var loginSection = '/login';\n\n  var _useContext = useContext(UserContext),\n      appData = _useContext[0],\n      setAppData = _useContext[1],\n      loggedIn = _useContext[2],\n      setLoggedIn = _useContext[3];\n\n  var _useState = useState({\n    email: '',\n    name: ''\n  }),\n      userData = _useState[0],\n      setUserData = _useState[1];\n\n  var _useState2 = useState(null),\n      adminEmails = _useState2[0],\n      setAdminEmails = _useState2[1];\n\n  var _useState3 = useState(false),\n      admin = _useState3[0],\n      setAdmin = _useState3[1];\n\n  if (firebase.apps.length === 0) {\n    firebase.initializeApp(firebaseConfig);\n  }\n\n  useEffect( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var response;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch('http://localhost:2000/api/admin/getAllAdmins');\n\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return response.json();\n\n          case 5:\n            response = _context.sent;\n            setAdminEmails(response.email);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  console.log(adminEmails); // localStorage.setItem('_increment', JSON.stringify(appData));\n  // }, []);\n\n  var handleGoogleSignIn = function handleGoogleSignIn() {\n    var provider = new firebase.auth.GoogleAuthProvider();\n    firebase.auth().signInWithPopup(provider).then( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result) {\n        var _yield$result$user, displayName, email, loggedInUser, adminEmail;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return result.user;\n\n              case 2:\n                _yield$result$user = _context2.sent;\n                displayName = _yield$result$user.displayName;\n                email = _yield$result$user.email;\n                loggedInUser = {\n                  name: displayName,\n                  email: email\n                }; //localStorage.setItem('data', loggedInUser);\n\n                setUserData(_objectSpread(_objectSpread({}, loggedInUser), {}, {\n                  name: displayName,\n                  email: email\n                })); //localStorage.setItem('data', loggedInUser);\n                // window.store = loggedInUser;\n\n                console.log(loggedInUser);\n                console.log(userData);\n                adminEmail = adminEmails.filter(function (data) {\n                  return data.email == loggedInUser.email;\n                });\n                console.log(adminEmail);\n\n                if (!adminEmail[0].email) {\n                  setAdmin(false);\n                  router.push(loginSection);\n                }\n\n                if (adminEmail[0].email) {\n                  setAdmin(true);\n                  router.push(dashboardSection);\n                } // if (typeof window !== 'undefined') {\n                //   localStorage.setItem(data, loggedInUser);\n                // }\n\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }())[\"catch\"](function (error) {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n      var email = error.email;\n      var credential = error.credential;\n      console.log(errorCode, email, credential, errorMessage);\n    });\n  };\n\n  return /*#__PURE__*/_jsx(Container, {\n    children: /*#__PURE__*/_jsx(Row, {\n      className: \"my-5 text-center\",\n      children: /*#__PURE__*/_jsxs(Col, {\n        className: styles.authSection,\n        md: {\n          span: 6,\n          offset: 3\n        },\n        sm: {\n          span: 12\n        },\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsxs(\"a\", {\n            children: [' ', /*#__PURE__*/_jsx(Image, {\n              src: \"/favicon.png\",\n              width: 300,\n              height: 100,\n              alt: \"logo image\"\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.googleAuthSection,\n          children: /*#__PURE__*/_jsx(Button, {\n            variant: \"outline-danger\",\n            onClick: handleGoogleSignIn,\n            children: \"Continue With google\"\n          })\n        })]\n      })\n    })\n  });\n};\n\nexport default Login; // export async function getServerSideProps() {\n//   const res = await fetch('');\n//   const getAdminEmail = await res.json();\n//   return {\n//     props: {\n//       getAdminEmail,\n//     },\n//   };\n// }","map":null,"metadata":{},"sourceType":"module"}